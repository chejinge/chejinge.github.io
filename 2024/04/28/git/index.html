<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>git教程 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="各个命令的详细使用方法参考git-docs。">
<meta property="og:type" content="article">
<meta property="og:title" content="git教程">
<meta property="og:url" content="http://example.com/2024/04/28/git/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="各个命令的详细使用方法参考git-docs。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-04-28T10:58:11.000Z">
<meta property="article:modified_time" content="2024-04-28T11:44:54.148Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-git" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/28/git/" class="article-date">
  <time class="dt-published" datetime="2024-04-28T10:58:11.000Z" itemprop="datePublished">2024-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      git教程
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="各个命令的详细使用方法参考git-docs。Table-of-Contents"><a href="#各个命令的详细使用方法参考git-docs。Table-of-Contents" class="headerlink" title="各个命令的详细使用方法参考git-docs。Table of Contents"></a><strong>各个命令的详细使用方法参考<a target="_blank" rel="noopener" href="https://git-scm.com/docs">git-docs</a>。</strong><br><span id="more"></span><br>Table of Contents</h1><ul>
<li><a href="#git">git</a></li>
<li><a href="#table-of-contents">Table of Contents</a><ul>
<li><a href="#add">add</a></li>
<li><a href="#archive">archive</a></li>
<li><a href="#blame">blame</a></li>
<li><a href="#branch">branch</a></li>
<li><a href="#checkout">checkout</a></li>
<li><a href="#cherry-pick">cherry-pick</a></li>
<li><a href="#clone">clone</a></li>
<li><a href="#commit">commit</a></li>
<li><a href="#config">config</a></li>
<li><a href="#diff">diff</a></li>
<li><a href="#fetch">fetch</a></li>
<li><a href="#for-each-ref">for-each-ref</a></li>
<li><a href="#github">github</a></li>
<li><a href="#init">init</a></li>
<li><a href="#log-show">log &amp; show</a></li>
<li><a href="#merge">merge</a></li>
<li><a href="#mv">mv</a></li>
<li><a href="#pull">pull</a></li>
<li><a href="#push">push</a></li>
<li><a href="#rebase">rebase</a></li>
<li><a href="#remote">remote</a></li>
<li><a href="#rm-file">rm file</a></li>
<li><a href="#reset">reset</a></li>
<li><a href="#revert">revert</a></li>
<li><a href="#stash">stash</a></li>
<li><a href="#submodule">submodule</a></li>
<li><a href="#subtree">subtree</a></li>
<li><a href="#tag">tag</a></li>
<li><a href="#upstream">upstream</a></li>
<li><a href="#%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0">底层实现</a></li>
<li><a href="#questions">questions</a></li>
</ul>
</li>
</ul>
<h2 id="add"><a href="#add" class="headerlink" title="add"></a>add</h2><ul>
<li>git add .  # 添加当前目录下的所有文件</li>
<li>git add -N # 在使用 “git commit -a” 提交文件之后，如果发现某个新加文件忘记提交，可以使用这个命令把某个新文件追加到最近一次 commit 中</li>
<li>git add -p # &#x3D;&#x3D; git add –patch，查看本次add的内容，这个过程有很多交互式命令选项，可以输入 ? 查看各个子命令的意思</li>
<li>git add -f xxx # 如果某类文件在 gitignore 中被要求不要提交，可以通过 -f 参数强制提交</li>
</ul>
<h2 id="archive"><a href="#archive" class="headerlink" title="archive"></a>archive</h2><ul>
<li>git archive v1.3 | gzip &gt; .&#x2F;ldb.tgz</li>
<li>git archive master &gt; .&#x2F;ldb.zip</li>
<li>git archive –format zip –output .&#x2F;ldb.zip v1.3</li>
<li>git archive –format tgz –output .&#x2F;ldb.tgz master</li>
</ul>
<h2 id="blame"><a href="#blame" class="headerlink" title="blame"></a>blame</h2><ul>
<li>git blame filename # 可以查看某个文件的详细修改历史</li>
</ul>
<h2 id="branch"><a href="#branch" class="headerlink" title="branch"></a>branch</h2><ul>
<li><p>git branch # 列出本地的分支</p>
</li>
<li><p>git branch -vv  # 列出分支并查看每个分支的详情</p>
</li>
<li><p>git branch -av # 查看远程所有分支</p>
</li>
<li><p>git branch -r # 查看远程分支</p>
</li>
<li><p>git checkout branch-name # 切换到某个分支</p>
</li>
<li><p>git branch –contains 5a0e815e5 # 查看包含某个 commit id 的 本地 分支</p>
</li>
<li><p>git branch -r –contains 5a0e815e5 # 查看包含某个 commit id 的 远端 分支</p>
</li>
<li><p>git branch branch-name tag-name # 从某个 tag 拉取分支</p>
</li>
<li><p>git checkout -b branch-name # 创建某个分支</p>
</li>
<li><p>git checkout -b hotfix origin&#x2F;hotfix # 切换到远程分支 origin&#x2F;hotfix，本地名称叫做hotfix</p>
</li>
<li><p>git checkout commitId -b brach-name # 从某个 commit 拉出一个分支</p>
</li>
<li><p>git branch -m old new # 重命名本地分支名称</p>
</li>
<li><p>git branch -d branch-name # 尝试删除本地某个分支(删除分支之前一定要先切换到别的分支上面)</p>
</li>
<li><p>git branch -D <branchname> # 强制删除本地某个分支</p>
</li>
<li><p>git push origin –delete branch-name # 删除远程分支</p>
</li>
<li><p>git push origin :branch-name  #  冒号前面的空格不能少，原理是把一个空分支push到server上，相当于删除该分支。</p>
</li>
<li><p>git push -d origin branch-name # 作用同上</p>
</li>
<li><p>git branch -m <oldbranchname> <newbranchname>   # 尝试修改</p>
</li>
<li><p>git branch -M <oldbranchname> <newbranchname>    # 强制修改</p>
</li>
<li><p>git push origin develop:master -f # 把本地的 develop 分支强制推送到远端的 master，称之为 覆盖</p>
</li>
<li><p>git pull upstream feature&#x2F;mq:feature&#x2F;mq # 拉取上游分支 feature&#x2F;mq 到本地分支 feature&#x2F;mq</p>
</li>
</ul>
<h2 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h2><ul>
<li>git checkout -p # 等同于 “git checkout –patch”，查看checkout的改动内容。某些场景下这非常有用，例如，在你跟踪一个 bug 时引入了一堆调试日志语句，在修正了这个 bug 之后，你可以先使用 git checkout -p 删除所有新加的调试日志，之后使用 git add -p 来添加 bug 修复。没有比组合一个极好的、结构良好的提交更令人满意的了！</li>
<li>git checkout - # 切换到上一个分支</li>
<li>git checkout HEAD~2  # 将HEAD移动到当前commit的前两个commit上，同时更新workspace</li>
</ul>
<h2 id="cherry-pick"><a href="#cherry-pick" class="headerlink" title="cherry-pick"></a>cherry-pick</h2><ul>
<li>git cherry-pick ci # 获取ci并自动提交</li>
<li>git cherry-pick -n ci # 获取ci但不自动提交</li>
<li>git co master &amp;&amp; git cherry-pick commit-hash-start^..commit-hash-end # develop 分支比 master 多出了很多 commits ，此命令可将 develop 分支中的连续多个 commits 提取到 master</li>
<li>git reflog &amp; git cherry-pick #  reset 之后，可以通过 reflog 命令找回提交的 ID，如果还想使用某个 ID，可以通过 cherry-pick 命令将这些 commit 摘取出来重新提交。</li>
</ul>
<h2 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h2><ul>
<li>git clean -fd # 强制删除尚未执行 “git add” 命令处于 “untracked” 状态的文件和目录。f 是强制删除，d 是把目录也删掉。</li>
</ul>
<h2 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h2><ul>
<li>git clone <a target="_blank" rel="noopener" href="https://github.com/alexstocks/test">https://github.com/alexstocks/test</a> .&#x2F;dest_dir –depth 1 # 只克隆最近一次commit，最后的 @dest_dir 可以不要</li>
</ul>
<h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><ul>
<li>git commit –amend   # 可以修改最后一次提交的信息.但是如果你已经push过了，那么其历史最后一次，永远也不能修改了。 这种方式可以比较方便的保持原有的Change-Id，推荐使用。</li>
<li>git commit –amend -m “”  # 补加，并且修改上次提交的信息</li>
<li>git commit –amend –signoff # 等效于 <code>git ci -a -s</code>，修改 ci 的账号信息，即便已经通过 git ps origin head 进行了提交。当然通过这个命令修改后，须通过 git ps -f origin head 强行提交。</li>
<li>git commit -am “some sthing” # 将add和commit合并成一条命令。<a target="_blank" rel="noopener" href="http://www.cnblogs.com/xiaohuochai/p/6664451.html">m与am的区别</a></li>
<li>git commit -a # 此时会出现默认的编辑器，提示用户填写 commit message。如果默认编辑器是 vim，则当前环境最好没有用户自定义的 .vimrc，否则会提示错误。</li>
<li>git commit –amend –author&#x3D;”xxx” # 修改作者信息</li>
</ul>
<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><ul>
<li>git config -l # 查看本地配置</li>
<li>git config —-global —-list</li>
</ul>
<blockquote>
<p> 编辑代码库根目录.git&#x2F;config，增加GitLab 远程库</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;gitlab&quot;]</span><br><span class="line">    url = git@1.2.1.1:l/a.git</span><br><span class="line">    fetch = +refs/heads/*:refs/remotes/gitlab/*</span><br><span class="line">    pushurl = git@1.2.1.1:l/a.git</span><br><span class="line">    pushurl = git@1.2.1.1:l/b.git</span><br></pre></td></tr></table></figure>

<p>上面设置两个pushurl，用于同时推送到两个gitlab上，也可以通过如下两个命令达到同样的效果：<br>git remote set-url –add –push origin <a href="mailto:&#x67;&#x69;&#x74;&#x40;&#x31;&#x2e;&#x32;&#x2e;&#x31;&#46;&#49;">&#x67;&#x69;&#x74;&#x40;&#x31;&#x2e;&#x32;&#x2e;&#x31;&#46;&#49;</a>:l&#x2F;a.git<br>git remote set-url –add –push origin <a href="mailto:&#103;&#x69;&#x74;&#64;&#49;&#x2e;&#50;&#x2e;&#x31;&#46;&#x31;">&#103;&#x69;&#x74;&#64;&#49;&#x2e;&#50;&#x2e;&#x31;&#46;&#x31;</a>:l&#x2F;b.git </p>
<blockquote>
<p>global</p>
</blockquote>
<ul>
<li>git config –global color.ui true # 使语法着色，让命令更加突出</li>
<li>git config –list # 查看config信息</li>
<li>git config –global user.name “shenguotao”</li>
<li>git config –global user.email “<a href="mailto:&#x73;&#103;&#116;&#95;&#x61;&#104;&#64;&#49;&#54;&#x33;&#x2e;&#99;&#111;&#x6d;">&#x73;&#103;&#116;&#95;&#x61;&#104;&#64;&#49;&#54;&#x33;&#x2e;&#99;&#111;&#x6d;</a>“</li>
<li>git config –global alias.logg “log –graph –decorate –abbrev-commit –all” # 美化log</li>
<li>git config –global push.default simple     # 设置上传代码的分支</li>
<li>git config –unset –global user.name # 清除配置信息</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nothing: 直接push会出错，需要显式的指出推送的远程分支，例如:git push origin master；</span><br><span class="line">current: 推送时只会推送当前所在的分支到远程同名分支，如果远程分支不存在相应的同名分支，则创建该分支；</span><br><span class="line">upstream: 推送当前分支到它的upstream分支上，这个模式只适用于推送到与拉取数据相同的仓库(比如central workflow)；</span><br><span class="line">simple: 在中央仓库工作流程模式下，只能推送到与本地分支名一致的upstream分支中，如果推送的远程仓库和拉取数据的远程仓库不一致，那么该模式会像current模式一样进行操作。因为该选项对于新手来说是最安全的，所以在git 2.0中，simple是push.default的默认值配置项(2.0以前的默认配置项是matching)；</span><br><span class="line">matching:推送本地和远程都存在的同名分支。</span><br></pre></td></tr></table></figure>

<ul>
<li>git config –global core.autocrlf false     # 让Git不要管Windows&#x2F;Unix换行符转换的事</li>
</ul>
<blockquote>
<p>alias</p>
</blockquote>
<ul>
<li>git config –global alias.st status</li>
<li>git config –global alias.co checkout</li>
<li>git config –global alias.ci commit</li>
<li>git config –global alias.br branch</li>
<li>git config –global alias.pl pull</li>
<li>git config –global alias.ps push</li>
</ul>
<p><strong>上面使用了“global”选项，则这些内容会存入“~&#x2F;.gitconfig”中，如果没有这个选项则只会存储具体项目的的”.git&#x2F;config”中。</strong></p>
<h2 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h2><ul>
<li>git diff HEAD@{yesterday}  # 会看到从昨天以来的所有修改</li>
<li>git diff HEAD@{‘2 months ago’}</li>
<li>git diff HEAD@{‘2010-01-01 12:00:00’} # 一个确切的日期以来的修改</li>
<li>git config –global diff.tool vimdiff # 可以执行 <code>git difftool</code> 命令通过调用 vimdiff 查看代码改动，可以在 .vimrc 中添加 <code>if &amp;diff\n set number\n endif</code> 这条指令，以在比较时显示行号</li>
</ul>
<h2 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h2><ul>
<li>git fetch –prune # 本地 git 项目和 github 项目经过一段时间的演进，本地与远端分支可能不一致，譬如本地可能存在但是远端不存在，此时需要通过这个命令把远端的分支同步到本地</li>
</ul>
<h2 id="for-each-ref"><a href="#for-each-ref" class="headerlink" title="for-each-ref"></a>for-each-ref</h2><ul>
<li>git for-each-ref –format&#x3D;’%(committerdate) %09 %(authorname) %09 %(refname)’ | sort -k5n -k2M -k3n -k4n # 查看分支的创建者、创建时间</li>
</ul>
<h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><ul>
<li>查看某人对某个项目的提交记录 <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty/commits?author=AlexStocks">https://github.com/alexstocks/getty/commits?author=AlexStocks</a></li>
<li>gh 常用命令</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; 下载 <span class="built_in">pr</span></span><br><span class="line">1 gh <span class="built_in">pr</span> checkout pr-id</span><br><span class="line">2 修改代码，修改过程中可以使用 `gh <span class="built_in">pr</span> diff` 比对修改之处</span><br><span class="line">3 git add xxx</span><br><span class="line">4 git commit --amend/git commit -m <span class="string">&quot;&quot;</span></span><br><span class="line">5 git push -f</span><br><span class="line"></span><br><span class="line">&gt; 列出当前的 issue</span><br><span class="line">gh issue list</span><br><span class="line"></span><br><span class="line">&gt; 找到与你相关的 issue</span><br><span class="line">gh issue status</span><br></pre></td></tr></table></figure>

<h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><ul>
<li>git –git-dir&#x3D;lib1.git init –bare # 在本地创建名为 lib1 的 git</li>
</ul>
<h2 id="log-show"><a href="#log-show" class="headerlink" title="log &amp; show"></a>log &amp; show</h2><ul>
<li>git log -p # 查看提交的详细内容</li>
<li>git show log-id # 用于查看某次提交前后代码的diff，log-id可以是提交id的前五位</li>
<li>git log –graph –pretty&#x3D;format:’%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset’ –abbrev-commit –date&#x3D;relative # –graph 选项将图表添加到日志的左侧，–abbrev-commit 存储提交使用了 SHA 方法，–date&#x3D;relative 表达式用相对的术语来表示日期，并且  –pretty 以 bit 格式处理自定义格式。</li>
<li>git reflog  # 显示当前分支的所有活动的列表，并为您提供每个提交的 SHA1 值</li>
<li>git log –graph –abbrev-commit –decorate –oneline –simplify-by-decoration –all  # 查看分支图形结构</li>
</ul>
<h2 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h2><ul>
<li> git checkout develop</li>
<li> git branch -av</li>
<li> git merge –no-ff feature&#x2F;actlog # 强制merge</li>
<li> git branch -av</li>
<li> git push origin</li>
</ul>
<h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><ul>
<li>git mv -f oldfolder newfolder # 重命名文件夹 or 文件</li>
</ul>
<h2 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h2><ul>
<li>git pull  &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt; # 用于拉取位于服务器上的最新分支到本地并合并，它等效于 git fetch + git merge。命令git fetch 会拉取服务器上的分支并保存在版本库的某个文件夹下，命令git merge则会将拉取下来的版本库与本地版本库进行合并。</li>
<li>git pull -r origin master # 等同于 git fetch + git rebase</li>
<li>git pull —rebase # 等同于 <code>git pull -r</code>，建议每天编码之前和代码上传之前不定期、频繁的进行<code>git pull --rebase</code>，以检测代码冲突</li>
<li>git pull origin pull&#x2F;1941&#x2F;head:repack-org-apache  # <a target="_blank" rel="noopener" href="https://www.huangyunkun.com/2018/06/15/pull-github-pr-to-local-branch/">拉取Github PR代码到本地分支</a></li>
<li>git pull upstream feature&#x2F;mq:feature&#x2F;mq # 拉取上游分支 feature&#x2F;mq 到本地分支 feature&#x2F;mq</li>
<li>git pull <a target="_blank" rel="noopener" href="https://github.com/apache/dubbo-go">https://github.com/apache/dubbo-go</a> develop # 拉取更新 develop 分支的代码</li>
</ul>
<h2 id="push"><a href="#push" class="headerlink" title="push"></a>push</h2><ul>
<li>git push -f master_zhao:master</li>
<li>git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;</li>
<li>git push -d origin branch-name #  删除一个远程分支</li>
</ul>
<h2 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h2><ul>
<li>git rebase -i HEAD~4 # 将最近4个commit合并为1个，HEAD代表当前版本。将进入VIM界面，你可以修改提交信息。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">step1: git rebase -i HEAD~6</span><br><span class="line">step2: 在 vim 命令界面把 pick 修改为 squash，然后输入 vim  &#x27;x&#x27; 命令进行存储</span><br><span class="line">step3: 继续在 vim 界面修改 commit message</span><br><span class="line">step4: 有冲突则解决冲突，解决完冲突后则输入 &#x27;git rebase --continue&#x27; 命令</span><br><span class="line">step5: git add .</span><br><span class="line">step5.1: 在解决冲突过程中也可以不断输入 &#x27;git rebase --continue &amp;&amp; git add .&#x27;</span><br><span class="line">step6: git ps -f origin head</span><br></pre></td></tr></table></figure>

<h2 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h2><ul>
<li>git remove -v  这个命令可以显示对应项目的远程克隆地址</li>
<li>git remote add test <a href="https://github.com:AlexStocks/test">https://github.com:AlexStocks/test</a> # 把远程仓库简化为 test，用于替代长串的URL，在以后的推送和拉取中就可以使用这个简称来简化命令了。</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   尽量使用 `git remote add test https://github.com:AlexStocks/test`。</span><br><span class="line">   不要使用 `git remote add test git@github.com:AlexStocks/test.git`。</span><br><span class="line"></span><br><span class="line">   前者使用 https，后者使用 ssh 方式鉴权，使用命令 `git pull test master` 拉取代码的时候，可能报错如下：</span><br><span class="line"></span><br><span class="line">fatal: &#x27;upsteam&#x27; does not appear to be a git repository</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br><span class="line"></span><br><span class="line">如果出现以上错误，可以在 `.git/config` 中对 remote 代码地址进行修改。</span><br></pre></td></tr></table></figure>

<ul>
<li>git remote rm test # 删除上游分支</li>
<li>git remote remove test # 删除 test</li>
</ul>
<h2 id="rm-file"><a href="#rm-file" class="headerlink" title="rm file"></a>rm file</h2><ul>
<li>git rm a.txt</li>
<li>git rm -rf a.txt</li>
<li>git commit * -m “update”</li>
<li>git push origin master</li>
</ul>
<h2 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h2><ul>
<li>git reset –hard commit-id # commit-id可以通过git log查看，这个命令的意思是会退到相关的commit，把最新的提交撤销掉，彻底回退到某个版本，本地的源码也会变为上一个版本的内容，然后通过 git push -f origin head 就可以对远程仓库进行回退操作。</li>
<li>git reset —soft # 回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可</li>
<li>git reset –mixed # 此为默认方式，不带任何参数的git reset，它回滚 “git add”，只保留源码，回退commit和index信息</li>
<li>git reset –hard origin&#x2F;develop # 把当前分支的指针指向 develop 分支</li>
<li>git checkout – filename &amp;&amp; git reset HEAD filename ## 如果不小心 rm 了工作区的某文件，可通过这个操作恢复之。</li>
</ul>
<h2 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h2><ul>
<li>git revert HEAD      # 撤销前一次 commit</li>
<li>git revert HEAD^     # 撤销前前一次 commit</li>
<li>git revert fa042     # 撤销指定 commit id 为 fa042 的提交，撤销也会作为一次提交进行保存。之后进行 git commit 和 git push 即可。</li>
</ul>
<blockquote>
<p>git revert 撤销 某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销<br>作为一次最新的提交。建议不要使用 revert。</p>
</blockquote>
<pre><code>git revert 和 git reset的区别
1. git revert是用一次新的commit来回滚之前的commit，git reset是直接删除指定的commit。
2. 在回滚这一操作上看，效果差不多。但是在日后继续merge以前的老版本时有区别。因为git revert是用一次逆向的commit“中和”之前的提交，因此日后合并老的branch时，导致这部分改变不会再次出现，但是git reset是之间把某些commit在某个branch上删除，因而和老的branch再次merge时，这些被回滚的commit应该还会被引入。
3. git reset 是把HEAD向后移动了一下，而git revert是HEAD继续前进，只是新的commit的内容和要revert的内容正好相反，能够抵消要被revert的内容。
</code></pre>
<h2 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h2><ul>
<li>git stash  # 保存当前分支的工作状态</li>
<li>git stash save “xxxx” # 作用同上，不过给stash加上一个message</li>
<li>git stash list # 查看当前分支的stash列表</li>
<li>git stash pop # 恢复分支最新的工作状态</li>
<li>git stash apply stash@{0} # 恢复分支指定的工作状态,该命令可结合 git stash list 使用</li>
<li>git stash drop # 删除分支状态</li>
<li>git stash clear # 清空栈</li>
<li>git stash show -p stash@{2} # 查看 stash 内容</li>
</ul>
<h2 id="submodule"><a href="#submodule" class="headerlink" title="submodule"></a>submodule</h2><blockquote>
<p>添加子模块</p>
</blockquote>
<ul>
<li>git submodule add –force <a target="_blank" rel="noopener" href="https://github.com/divebomb/nemo.git">https://github.com/divebomb/nemo.git</a> third&#x2F;nemo # 添加子仓库之后，主仓库的对应目录下（这里为lib），并不是sub仓库的文件，而是对应的commit id。所以一旦有submodule发生修改，在子目录所在的目录调用 git pull 把代码下拉之后，还需<font color=red>在主项目目录下</font>通过 git ci &amp; git ps 把 submodule 最新的引用 ci id 予以上传。</li>
<li>git submodule init # 初始化本地配置文件</li>
<li>git submodule update # 检出父仓库列出的commit</li>
<li>git submodule update –init –recursive –force # 可以替换上面两个命令，一定要在repo根路径执行此命令</li>
<li>git pull origin master # 拉取子模块代码</li>
</ul>
<blockquote>
<p>删除子模块</p>
</blockquote>
<ul>
<li>git rm -r –cached &lt;本地路径&gt; # 将子模块所在的文件从git中删除</li>
<li>rm -rf &lt;本地路径&gt;</li>
<li>删除.gitmodule里相关部分</li>
<li>删除.git&#x2F;config 文件里相关字段</li>
<li>git commit -am “xxx”</li>
<li>git push origin master</li>
</ul>
<blockquote>
<p>拉取所有子模块</p>
</blockquote>
<ul>
<li>git submodule foreach –recursive git submodule init</li>
<li>git submodule foreach –recursive git submodule update</li>
<li>git submodule foreach git pull</li>
</ul>
<blockquote>
<p>更新子模块</p>
</blockquote>
<ul>
<li>git pull origin head # 在 submodule 目录中执行这个命令，拉取最新代码</li>
<li>git commit -am “xx” &amp;&amp; git push origin head # 如果子模块有更新，则在工程主目录下提交子模块的更新</li>
</ul>
<h2 id="subtree"><a href="#subtree" class="headerlink" title="subtree"></a>subtree</h2><ul>
<li>git subtree add –prefix&#x3D;examples <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty-examples.git">https://github.com/alexstocks/getty-examples.git</a> master –squash # 拉取远程 github repo 到本地目录 examples，squash参数表示不拉取历史信息，而只生成一条commit信息，拉取完毕后 git push 即可对项目进行提交</li>
<li>git subtree pull –prefix&#x3D;examples <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty-examples.git">https://github.com/alexstocks/getty-examples.git</a> master –squash   # 当远程分支更新后，用这个命令可以把更新给拉取下来</li>
<li>git subtree push –prefix&#x3D;examples <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty-examples.git">https://github.com/alexstocks/getty-examples.git</a> master # 如果在 examples 子目录下对代码进行了更改，可以通过这个手段把修改内容推送到 <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty-examples">https://github.com/alexstocks/getty-examples</a></li>
</ul>
<blockquote>
<p>上面的命令可以通过 git remote 进行简化：<br>git remote add -f getty-examples <a target="_blank" rel="noopener" href="https://github.com/alexstocks/getty-examples.git">https://github.com/alexstocks/getty-examples.git</a><br>git subtree add –prefix&#x3D;examples getty-examples master –squash<br>git subtree pull –prefix&#x3D;examples getty-examples master –squash<br>git subtree push –prefix&#x3D;examples getty-examples master</p>
</blockquote>
<p><font color=blue> subtree 主要用来管理业务组件代码，主工程和子工程都有可能更新。submodule 则适合用来管理公共基础库，只有基础库单向更新。 </font></p>
<h2 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h2><ul>
<li><p>git tag v0.4.05     # 创建本地tag，注意这种方式打出来的 tag 是主分支代码的 tag</p>
</li>
<li><p>git tag -a v0.1.2 -m “0.1.2版本” # 创建附注Tag, 参数a即annotated的缩, 后附Tag名, m &#x3D; mark，注意这种方式打出来的 tag 是主分支代码的 tag</p>
</li>
<li><p>git tag -a v0.1.1 9fbc3d0 # 给指定的commit打Tag</p>
</li>
<li><p>git push origin v0.4.05 # 创建远程tag</p>
</li>
<li><p>git push origin –tags # 将本地所有Tag一次性提交到git服务器</p>
</li>
<li><p>git push –tags # 作用同上</p>
</li>
<li><p>git archive v0.4.05 &gt; master.tar # 对 tag 内容进行打包</p>
</li>
<li><p>git tag -d v0.4.05 # 删除本地tag</p>
</li>
<li><p>git push origin :refs&#x2F;tags&#x2F;v0.4.05 # 删除远程tag</p>
</li>
<li><p>git tag -ln # 查看 tag 列表，并显示附注</p>
</li>
<li><p>git log –tags –simplify-by-decoration –pretty&#x3D;”format:%ci %d” # 显示 tag 以及打 tag 的时间</p>
</li>
<li><p>git show <tagName>  # 可以查看 tag 的提交信息</p>
</li>
<li><p>git show-ref # 查看所有 tag 的 hash 值</p>
</li>
<li><p>git show-ref -s  v1.1.0 # 查看 v1.1.0 tag 的 hash 值</p>
</li>
<li><p>git tag –contains 5a0e815e5 # 查某个commit在哪些tag或者branch下</p>
</li>
</ul>
<h2 id="upstream"><a href="#upstream" class="headerlink" title="upstream"></a>upstream</h2><ul>
<li>git remote -v # 可以查看上游仓库</li>
<li>git remote add upstream <a target="_blank" rel="noopener" href="https://github.com/antirez/redis.git">https://github.com/antirez/redis.git</a> # 配置remote</li>
<li>git fetch upstream # 从上游仓库获取到分支，及相关的提交信息，它们将被保存在本地的 upstream&#x2F;master 分支</li>
<li>git checkout master # 切换到本地的一个分支</li>
<li>git merge upstream&#x2F;master # 合并到本地的当前分支</li>
<li>git merge upstream&#x2F;master –allow-unrelated-histories # 如果用上面的命令 merge 的时候，报出 “refusing to merge unrelated histories” 错误，则使用这个命令替换之</li>
<li>git ci -am “xxx”</li>
<li>git push origin head # 提交到fork仓库</li>
</ul>
<p>**可以在”~&#x2F;.gitconfig”的[alias] section添加这样一条命令：um &#x3D; !”git fetch origin -v &amp;&amp; git fetch upstream -v &amp;&amp; git merge upstream&#x2F;master &amp;&amp; git push”**。这条命令执行前需要先通过上面第二条命令 “git remote add upstream <a target="_blank" rel="noopener" href="https://github.com/antirez/redis.git">https://github.com/antirez/redis.git</a>“ 配置好remote repo。</p>
<h2 id="底层实现"><a href="#底层实现" class="headerlink" title="底层实现"></a>底层实现</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mamingqian/p/9711975.html">深入理解Git的实现原理</a></p>
</blockquote>
<blockquote>
<p>1 数据库</p>
</blockquote>
<ul>
<li><p>git init  用于创建一个空的git仓库，或重置一个已存在的git仓库，其中 <code>.git/objects</code> 就是git数据库的存储位置。</p>
</li>
<li><p>git hash-object  git底层命令，用于向Git数据库中写入数据</p>
<blockquote>
<p>echo “version 1” | git hash-object -w –stdin<br>  83baae61804e65cc73a7201a7252750c76066a30<br>find .git&#x2F;objects&#x2F; -type f<br>  .git&#x2F;objects&#x2F;83&#x2F;baae61804e65cc73a7201a7252750c76066a30<br>hash值的前2位命名文件夹，后38位命名文件。<br>  这就是git数据库的存储方式，一个文件对应一条内容。</p>
</blockquote>
</li>
<li><p>git cat-file  git底层命令，用于查看Git数据库中数据</p>
<blockquote>
<p>git cat-file -t 83baa   # -t选项用于查看键值对的类型<br>  blob                    # blob是数据对象，是git数据库三大对象类型之一<br>git cat-file -p 83baa   # -p选项用于查看键值对应的数据内容<br>  version 1</p>
</blockquote>
<p>  git是一种对象数据库。</p>
</li>
</ul>
<blockquote>
<p>2 树对象（tree object）</p>
</blockquote>
<p>树对象（tree object）解决文件名保存的问题，树对象也能够将多个文件组织在一起。Git通过树（tree）对象将数据（blob）对象组织起来，这很类似于一种文件系统——blob对象对应文件内容，tree对象对应文件的目录和节点。一个树（tree）对象包含一条或多条记录，每条记录含有一个指向blob对象或tree对象的SHA-1指针，以及相应的模式、类型、文件名。</p>
<p>树对象主要解决了各个时间点文件和文件夹的变化，但是各个时间点变化的先后顺序就是 commit 对象负责的事情了。</p>
<ul>
<li><p>git update-index     git底层命令，用于创建暂存区</p>
<blockquote>
<p>git update-index –add file.txt    # .git&#x2F;index 被创建</p>
</blockquote>
</li>
<li><p>git ls-files –stage    git底层命令，用于查看暂存区内容</p>
</li>
<li><p>git write-tree          git底层命令，用于将暂存区内容写入一个树对象，.git&#x2F;objects 中会多出一个文件，用于存储 tree 对象</p>
</li>
</ul>
<blockquote>
<p>3 提交对象（commit object）</p>
</blockquote>
<p>commit 对象能够记录提交时间、提交作者、提交版本、父版本、版本说明。</p>
<ul>
<li>git commit-tree tree-object-hash -p parent-tree-object-hash -m “xxxx” # 创建提交对象（commit object）, -p 指定父提交对象，但若是第一次提交，则不需要指定。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; $ git write-tree</span><br><span class="line">      cb0fbcc484a3376b3e70958a05be0299e57ab495</span><br><span class="line">  	&gt; $ git commit-tree cb0fbcc -m &quot;first commit&quot;</span><br><span class="line">      7020a97c0e792f340e00e1bb8edcbafcc4dfb60f</span><br><span class="line">  &gt; $ git cat-file 7020a97</span><br><span class="line">      tree cb0fbcc484a3376b3e70958a05be0299e57ab495</span><br><span class="line">      author john &lt;john@163.com&gt; 1537961478 +0800</span><br><span class="line">      committer john &lt;john@163.com&gt; 1537961478 +0800</span><br><span class="line"></span><br><span class="line">      first commit</span><br></pre></td></tr></table></figure>

<p>上面的命令都是底层指令，使用多有不便，就提供了更高层的 add&#x2F;commit 等指令。Git 所做的实质工作是将被改写的文件保存为数据对象，更新暂存区，记录树对象，最后创建一个指明了顶层树对象和父提交的提交对象。 这三种主要的 Git 对象——数据对象、树对象、提交对象——最初均以单独文件的形式保存在 .git&#x2F;objects 目录下。</p>
<blockquote>
<p>4 引用和tag对象</p>
</blockquote>
<p>版本和数据对象的操作都是基于hash键值的，git 引入 <code>引用（references）</code> 这一概念解决这个问题。git的引用类似于一个指针，它指向的是某一个hash键值，其指向的 hash 值保存在.git&#x2F;refs目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; $ echo &quot;491404fa6e6f95eb14683c3c06d10ddc5f8e883f&quot; &gt; .git/refs/heads/master</span><br><span class="line">&gt; $ cat .git/refs/heads/master</span><br><span class="line">    491404fa6e6f95eb14683c3c06d10ddc5f8e883f</span><br></pre></td></tr></table></figure>
<p>如此成功的建立了一个指向最新一个提交 <code>49140</code> 的引用，引用名为master。执行 <code>git log master</code> 便等同于 <code>git log 49140</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; $ git update-ref refs/heads/master 49140   # 此处一条指令上面等同于上面两条指令</span><br></pre></td></tr></table></figure>

<p>分支和tags都是引用概念的延伸，Git 分支的本质：一个指向某一系列提交之首的指针或引用。</p>
<h2 id="questions"><a href="#questions" class="headerlink" title="questions"></a>questions</h2><blockquote>
<p>在GitLab添加SSH key</p>
</blockquote>
<ul>
<li>参考<a target="_blank" rel="noopener" href="https://docs.gitlab.com/ce/gitlab-basics/create-your-ssh-keys.html">https://docs.gitlab.com/ce/gitlab-basics/create-your-ssh-keys.html</a></li>
</ul>
<blockquote>
<p>push代码的时候遇到protect提示 “You are not allowed to force push code to a protected branch on this project”</p>
</blockquote>
<ul>
<li>“settings -&gt; Protected Branches” 在这里面可以对相关branch是否处于protect模式进行设置。</li>
</ul>
<blockquote>
<p>免密</p>
</blockquote>
<p>首先配置~&#x2F;.ssh&#x2F;config，然后配置代码repo下的.git&#x2F;config:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">    url = https://github.com/alexstocks/</span><br><span class="line">    fetch = +refs/heads/*:refs/remotes/origin/*</span><br></pre></td></tr></table></figure>

<p>修改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">    url = git@github:AlexStocks/test</span><br><span class="line">    fetch = +refs/heads/*:refs/remotes/origin/*</span><br></pre></td></tr></table></figure>

<p><font color=red><strong>把https方式push改为ssh方式push，此时.ssh下面的配置就起作用了。</strong></font></p>
<blockquote>
<p>查看某人在某个项目的所有 commit</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/dubbo-go-pixiu/commits?author=baerwang">https://github.com/apache/dubbo-go-pixiu/commits?author=baerwang</a></li>
</ul>
<blockquote>
<p>查看一个项目的 release tag 列表</p>
</blockquote>
<ul>
<li>curl <a target="_blank" rel="noopener" href="https://api.github.com/repos/fmtlib/fmt/releases">https://api.github.com/repos/fmtlib/fmt/releases</a> | grep 9.1.0 -C 5</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/04/28/git/" data-id="clvje2nhw0000eltb8fhzfgw7" data-title="git教程" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/04/28/pika%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%B5%81%E7%A8%8B%E8%A7%A3%E6%9E%90/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          pika执行命令流程解析
        
      </div>
    </a>
  
  
    <a href="/2024/04/28/failover/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">failover</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/04/30/Rocksdb-Blockcache%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">Rocksdb Blockcache学习</a>
          </li>
        
          <li>
            <a href="/2024/04/29/kubernetest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">kubernetest学习笔记</a>
          </li>
        
          <li>
            <a href="/2024/04/28/pika%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%B5%81%E7%A8%8B%E8%A7%A3%E6%9E%90/">pika执行命令流程解析</a>
          </li>
        
          <li>
            <a href="/2024/04/28/git/">git教程</a>
          </li>
        
          <li>
            <a href="/2024/04/28/failover/">failover</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>